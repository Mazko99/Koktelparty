<!DOCTYPE html>
<html lang="uk">
<head>
  <meta charset="UTF-8">
  <title>–ü—Ä–æ—Ñ—ñ–ª—å</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
  <style>
    body {
      background-color: #000;
      color: #fff;
      font-family: 'Orbitron', sans-serif;
    }
    .menu {
      display: flex;
      justify-content: center;
      gap: 30px;
      margin-top: 20px;
      font-size: 18px;
    }
    .menu a {
      color: #d9b3ff;
      text-decoration: none;
    }
    .menu a:hover {
      text-shadow: 0 0 10px #ff00ff;
    }
    .container-box {
      background-color: #111;
      border: 2px solid #6600cc;
      border-radius: 20px;
      padding: 30px;
      margin-top: 30px;
      box-shadow: 0 0 25px #9900ff;
    }
    .form-control, .btn {
      background-color: #1a1a1a;
      color: #fff;
      border: 1px solid #444;
    }
    .form-label, h2, h4 {
      color: #d9b3ff;
    }
    .verified-box {
      border: 2px solid #9900ff;
      color: #fff;
      background: #2a003f;
      border-radius: 10px;
      padding: 10px;
      text-align: center;
      font-weight: bold;
      margin-bottom: 20px;
    }
    .gallery-scroll {
      display: flex;
      overflow-x: auto;
      gap: 10px;
      padding-bottom: 10px;
    }
    .media-item {
      flex: 0 0 auto;
      min-width: 180px;
      max-width: 200px;
    }
    .media-item img,
    .media-item video {
      width: 100%;
      border-radius: 8px;
    }
    .product-card {
      background-color: #1c002f;
      border: 1px solid #7a00cc;
      color: #fff;
      border-radius: 10px;
      padding: 10px;
      max-width: 240px;
      text-align: center;
    }
    .product-card img {
      width: 100%;
      border-radius: 8px;
    }
    .neon-btn {
      background-color: transparent;
      border: 1px solid #d9b3ff;
      color: #d9b3ff;
      border-radius: 8px;
      padding: 5px 15px;
      transition: 0.3s;
    }
    .neon-btn:hover {
      background-color: #d9b3ff;
      color: #000;
      box-shadow: 0 0 15px #d9b3ff;
    }
  </style>
</head>
<body>
<div class="menu">
  <a href="/home">üè† –ì–æ–ª–æ–≤–Ω–∞</a>
  <a href="/profile">üë§ –ü—Ä–æ—Ñ—ñ–ª—å</a>
  <a href="/logout">üìï –í–∏–π—Ç–∏</a>
</div>

<div class="container container-box">
  <h2>–ü—Ä–æ—Ñ—ñ–ª—å –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞ {{ username }}</h2>

  {% if user[9] == 1 %}
    <div class="verified-box">‚úÖ –í–µ—Ä–∏—Ñ—ñ–∫–æ–≤–∞–Ω–æ</div>
  {% endif %}

  {% if last_seen %}
    {% set delta = (datetime.utcnow() - last_seen).total_seconds() %}
    <p>
      {% if delta < 120 %}üü¢ –ó–∞—Ä–∞–∑ –≤ –º–µ—Ä–µ–∂—ñ
      {% else %}üïì –ë—É–≤ —É –º–µ—Ä–µ–∂—ñ {{ (delta // 60)|int }} —Ö–≤ —Ç–æ–º—É
      {% endif %}
    </p>
  {% endif %}

  {% if session['username'] == username %}
  <form method="POST" action="/update_profile" enctype="multipart/form-data">
    <div class="row">
      <div class="col-md-3 text-center">
        <img src="/{{ user[4] or 'static/Sample_User_Icon.png' }}" class="img-thumbnail mb-2" style="max-width: 120px;">
        <input type="file" name="avatar" class="form-control mt-2">
      </div>
      <div class="col-md-9">
        <label class="form-label">–û–ø–∏—Å:</label>
        <textarea name="description" class="form-control" maxlength="150">{{ user[5] or '' }}</textarea>

        <label class="form-label mt-3">–ö–∞—Ç–µ–≥–æ—Ä—ñ—è:</label>
        <select name="category" class="form-control">
          <option value="–ë–µ–∑ –∫–∞—Ç–µ–≥–æ—Ä—ñ—ó" {% if user[8] == '–ë–µ–∑ –∫–∞—Ç–µ–≥–æ—Ä—ñ—ó' %}selected{% endif %}>–ë–µ–∑ –∫–∞—Ç–µ–≥–æ—Ä—ñ—ó</option>
          <option value="–í—ñ—Ä—Ç—É–∞–ª—å–Ω—ñ –º–æ–¥–µ–ª—ñ" {% if user[8] == '–í—ñ—Ä—Ç—É–∞–ª—å–Ω—ñ –º–æ–¥–µ–ª—ñ' %}selected{% endif %}>–í—ñ—Ä—Ç—É–∞–ª—å–Ω—ñ –º–æ–¥–µ–ª—ñ</option>
          <option value="–Ü–Ω–¥–∏–≤—ñ–¥—É–∞–ª–∫–∏" {% if user[8] == '–Ü–Ω–¥–∏–≤—ñ–¥—É–∞–ª–∫–∏' %}selected{% endif %}>–Ü–Ω–¥–∏–≤—ñ–¥—É–∞–ª–∫–∏</option>
        </select>

        <label class="form-label mt-3">–ú—ñ—Å—Ç–æ:</label>
        <select name="city" class="form-control">
          <option value="">–û–±–µ—Ä—ñ—Ç—å –º—ñ—Å—Ç–æ</option>
          <option {% if user[10] == '–ö–∏—ó–≤' %}selected{% endif %}>–ö–∏—ó–≤</option>
          <option {% if user[10] == '–õ—å–≤—ñ–≤' %}selected{% endif %}>–õ—å–≤—ñ–≤</option>
          <option {% if user[10] == '–•–∞—Ä–∫—ñ–≤' %}selected{% endif %}>–•–∞—Ä–∫—ñ–≤</option>
          <option {% if user[10] == '–û–¥–µ—Å–∞' %}selected{% endif %}>–û–¥–µ—Å–∞</option>
          <option {% if user[10] == '–î–Ω—ñ–ø—Ä–æ' %}selected{% endif %}>–î–Ω—ñ–ø—Ä–æ</option>
          <option {% if user[10] == '–ó–∞–ø–æ—Ä—ñ–∂–∂—è' %}selected{% endif %}>–ó–∞–ø–æ—Ä—ñ–∂–∂—è</option>
          <option {% if user[10] == '–Ü–≤–∞–Ω–æ-–§—Ä–∞–Ω–∫—ñ–≤—Å—å–∫' %}selected{% endif %}>–Ü–≤–∞–Ω–æ-–§—Ä–∞–Ω–∫—ñ–≤—Å—å–∫</option>
          <option {% if user[10] == '–¢–µ—Ä–Ω–æ–ø—ñ–ª—å' %}selected{% endif %}>–¢–µ—Ä–Ω–æ–ø—ñ–ª—å</option>
          <option {% if user[10] == '–ß–µ—Ä–Ω—ñ–≤—Ü—ñ' %}selected{% endif %}>–ß–µ—Ä–Ω—ñ–≤—Ü—ñ</option>
          <option {% if user[10] == '–£–∂–≥–æ—Ä–æ–¥' %}selected{% endif %}>–£–∂–≥–æ—Ä–æ–¥</option>
          <option {% if user[10] == '–ü–æ–ª—Ç–∞–≤–∞' %}selected{% endif %}>–ü–æ–ª—Ç–∞–≤–∞</option>
          <option {% if user[10] == '–ß–µ—Ä–Ω—ñ–≥—ñ–≤' %}selected{% endif %}>–ß–µ—Ä–Ω—ñ–≥—ñ–≤</option>
          <option {% if user[10] == '–ñ–∏—Ç–æ–º–∏—Ä' %}selected{% endif %}>–ñ–∏—Ç–æ–º–∏—Ä</option>
          <option {% if user[10] == '–•–º–µ–ª—å–Ω–∏—Ü—å–∫–∏–π' %}selected{% endif %}>–•–º–µ–ª—å–Ω–∏—Ü—å–∫–∏–π</option>
        </select>

        <button type="submit" class="btn btn-primary mt-3">–ó–±–µ—Ä–µ–≥—Ç–∏ –∑–º—ñ–Ω–∏</button>
      </div>
    </div>
  </form>
  {% else %}
    <div class="text-end">
      <a href="/chat_with/{{ username }}" class="btn neon-btn">üí¨ –ù–∞–ø–∏—Å–∞—Ç–∏</a>
    </div>
  {% endif %}

  <h4 class="mt-4">–ì–∞–ª–µ—Ä–µ—è</h4>
  <div class="gallery-scroll mb-3">
    {% for filename in photos %}
    <div class="media-item">
      {% set ext = filename.split('.')[-1].lower() %}
      {% if ext in ['jpg', 'jpeg', 'png'] %}
        <img src="{{ url_for('static', filename='uploads/' ~ username ~ '/' ~ filename) }}">
      {% elif ext in ['mp4', 'webm'] %}
        <video controls><source src="{{ url_for('static', filename='uploads/' ~ username ~ '/' ~ filename) }}"></video>
      {% endif %}
      {% if session['username'] == username %}
      <form action="/delete_photo" method="POST">
        <input type="hidden" name="filename" value="{{ filename }}">
        <button class="btn btn-sm btn-danger mt-2">–í–∏–¥–∞–ª–∏—Ç–∏</button>
      </form>
      {% endif %}
    </div>
    {% endfor %}
  </div>

  {% if session['username'] == username %}
  <form action="/upload_media" method="POST" enctype="multipart/form-data">
    <label>–ó–∞–≤–∞–Ω—Ç–∞–∂–∏—Ç–∏ –º–µ–¥—ñ–∞:</label>
    <input type="file" name="media_files" class="form-control" multiple required>
    <button class="btn btn-success mt-2">–ó–∞–≤–∞–Ω—Ç–∞–∂–∏—Ç–∏</button>
  </form>
  {% endif %}

  <h4 class="mt-4">–¢–æ–≤–∞—Ä–∏</h4>
  {% if session['username'] == username %}
    <a href="/add_product" class="btn neon-btn mb-2">‚ûï –î–æ–¥–∞—Ç–∏ —Ç–æ–≤–∞—Ä</a>
  {% endif %}
  <div class="d-flex flex-wrap gap-3">
    {% for product in products %}
      <div class="product-card">
        <img src="{{ url_for('static', filename='uploads/' + product[4]) }}">
        <strong>{{ product[1] }}</strong>
        <small>{{ product[2] }}</small>
        <div>üí∞ {{ product[3] }} –≥—Ä–Ω</div>
        {% if session['username'] == username %}
        <form method="POST" action="/delete_product">
          <input type="hidden" name="product_id" value="{{ product[0] }}">
          <button class="btn btn-sm btn-danger mt-1">–í–∏–¥–∞–ª–∏—Ç–∏</button>
        </form>
        {% endif %}
      </div>
    {% endfor %}
  </div>
</div>
</body>
</html>
